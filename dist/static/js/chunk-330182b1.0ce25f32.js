(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-330182b1"],{"0300":function(t,e,i){},1019:function(t,e,i){},"272e":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("VueDrr",{staticClass:"element-drr-wrapper",attrs:{x:t.element.x,y:t.element.y,w:t.element.w,h:t.element.h,handles:t.handles,active:t.element.active,minw:80,minh:18,parent:!0,rotatable:!1},on:{dragstop:t.handleDragStop,resizing:t.handleResizing,resizestop:t.handleResizeStop,deactivated:t.handleDeactivate,activated:t.handleActivated}},[t._t("default")],2)},n=[],l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"z-drr-container",class:{"z-draggable":t.draggable,"z-resizable":t.resizable,"z-rotatable":t.rotatable,"z-active":t.enabled,"z-dragging":t.dragging,"z-resizing":t.resizing,"z-rotating":t.rotating},style:t.style,on:{mousedown:t.elmDown}},[t.rotatable?e("div",{staticClass:"z-rotateable-handle",style:{display:t.enabled?"block":"none"},on:{touchstart:function(e){return e.preventDefault(),e.stopPropagation(),t.elmDown.apply(null,arguments)},mousedown:function(e){e.stopPropagation(),e.preventDefault(),t.rotating=!0},dblclick:t.fillParent}}):t._e(),t._l(t.handles,(function(i){return t.resizable?e("div",{key:i,staticClass:"z-resizeable-handle",class:"z-handle-"+i,style:{display:t.enabled?"block":"none"},on:{touchstart:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDown(i,e)},mousedown:function(e){return e.stopPropagation(),e.preventDefault(),t.handleResizeStart(i,e)}}}):t._e()})),t._t("default")],2)},a=[];function h(t){return"function"===typeof t||"[object Function]"===Object.prototype.toString.call(t)}function o(t,e,i){let s=t;const n=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(t=>h(s[t]));if(!h(s[n]))return!1;do{if(s[n](e))return!0;if(s===i)return!1;s=s.parentNode}while(s);return!1}var r={name:"VueDrr",props:{active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!0},canDeactive:{type:Boolean,default:!0},w:{type:[Number],default:200},h:{type:[Number,String],default:28,validator:function(t){const e="string"===typeof t?"auto"===t:t>=0;return e}},ratio:{type:[Number,String]},contains:{type:Boolean,default:!1},minw:{type:Number,default:28,validator(t){return t>0}},minh:{type:Number,default:28,validator(t){return t>0}},angle:{type:Number,default:0,validator(t){return"number"===typeof t}},x:{type:Number,default:0,validator(t){return"number"===typeof t}},y:{type:Number,default:0,validator(t){return"number"===typeof t}},z:{type:[String,Number],default:"auto",validator:function(t){const e="string"===typeof t?"auto"===t:t>=0;return e}},handles:{type:Array,default(){return["n","e","s","w","nw","ne","se","sw"]},validator:function(t){const e=new Set(["n","e","s","w","nw","ne","se","sw"]);return new Set(t.filter(t=>e.has(t))).size===t.length}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},axis:{type:String,default:"both",validator(t){return-1!==["x","y","both"].indexOf(t)}},grid:{type:Array,default(){return[1,1]}},parent:{type:Boolean,default:!1},overflowY:{type:String,default:""}},data(){return{top:this.y,left:this.x,width:this.w,height:this.h,rotateAngle:this.angle,resizing:!1,dragging:!1,rotating:!1,enabled:this.active,handle:null,zIndex:this.z,parentW:9999,parentH:9999,mouseX:0,mouseY:0,lastMouseX:0,lastMouseY:0,mouseOffX:0,mouseOffY:0,elmX:0,elmY:0,elmW:0,elmH:0}},computed:{style(){return{top:this.top+"px",left:this.left+"px",width:this.width+"px",height:this.height+"px",transform:"rotate("+this.rotateAngle+"deg)",zIndex:this.zIndex,overflowY:this.overflowY,overflowX:""}}},watch:{active(t){this.enabled=t},x(t){this.left=t,this.elmX=t},y(t){this.top=t,this.elmY=t},z:function(t){(t>=0||"auto"===t)&&(this.zIndex=t)},w(t){this.width=t,this.elmW=t},h(t){this.height=t,this.elmH=t},angle(t){this.rotateAngle=t}},mounted(){const t=document.querySelector(".editor-mask")||document.documentElement;t.addEventListener("mousedown",this.deselect,!1),t.addEventListener("mousemove",this.handleMove,!1),t.addEventListener("mouseup",this.handleUp,!1),t.addEventListener("touchmove",this.handleMove,!1),t.addEventListener("touchend touchcancel",this.deselect,!1),t.addEventListener("touchstart",this.handleUp,!1),this.elmX=parseInt(this.$el.style.left),this.elmY=parseInt(this.$el.style.top),this.elmW=this.$el.offsetWidth||this.$el.clientWidth,this.elmH=this.$el.offsetHeight||this.$el.clientHeight,this.reviewDimensions()},beforeDestroy(){const t=document.querySelector(".editor-mask")||document.documentElement;t.removeEventListener("mousedown",this.deselect,!1),t.removeEventListener("mousemove",this.handleMove,!1),t.removeEventListener("mouseup",this.handleUp,!1),t.addEventListener("touchmove",this.handleMove,!1),t.addEventListener("touchend touchcancel",this.deselect,!1),t.addEventListener("touchstart",this.handleUp,!1)},methods:{reviewDimensions(){if(this.minw>this.w&&(this.width=this.minw),this.minh>this.h&&(this.height=this.minh),this.parent){const t=parseInt(this.$el.parentNode.clientWidth,10),e=parseInt(this.$el.parentNode.clientHeight,10);this.parentW=t,this.parentH=e,this.w>this.parentW&&(this.width=t),this.h>this.parentH&&(this.height=e),this.x+this.w>this.parentW&&(this.width=t-this.x),this.y+this.h>this.parentH&&(this.height=e-this.y),this.elmW=this.width,this.elmH=this.height}this.$emit("resizing",this.left,this.top,this.width,this.height)},elmDown(t){const e=t.target||t.srcElement;if(this.$el.contains(e)){if(this.dragHandle&&!o(e,this.dragHandle,this.$el)||this.dragCancel&&o(e,this.dragCancel,this.$el))return;this.reviewDimensions(),this.enabled||(this.enabled=!0,this.$emit("activated"),this.$emit("update:active",!0)),this.draggable&&(this.dragging=!0)}},deselect(t){-1!==t.type.indexOf("touch")?(this.mouseX=t.changedTouches[0].clientX,this.mouseY=t.changedTouches[0].clientY):(this.mouseX=t.pageX||t.clientX+document.documentElement.scrollLeft,this.mouseY=t.pageY||t.clientY+document.documentElement.scrollTop),this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY;const e=t.target||t.srcElement,i=new RegExp("z-handle-([nesw]{1, 2})","");this.$el.contains(e)||i.test(e.className)||this.enabled&&this.canDeactive&&(this.enabled=!1,this.$emit("deactivated"),this.$emit("update:active",!1))},handleResizeStart(t,e){this.handle=t,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.resizing=!0},handleDown:function(t,e){this.handle=t,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.resizing=!0},fillParent:function(t){if(!this.parent||!this.resizable||!this.maximize)return;let e=!1;const i=()=>{e||window.requestAnimationFrame(i),"x"===this.axis?this.width===this.parentW&&0===this.left&&(e=!0):"y"===this.axis?this.height===this.parentH&&0===this.top&&(e=!0):"both"===this.axis&&this.width===this.parentW&&this.height===this.parentH&&0===this.top&&0===this.left&&(e=!0),"x"!==this.axis&&"both"!==this.axis||(this.width<this.parentW&&(this.width++,this.elmW++),this.left>0&&(this.left--,this.elmX--)),"y"!==this.axis&&"both"!==this.axis||(this.height<this.parentH&&(this.height++,this.elmH++),this.top>0&&(this.top--,this.elmY--)),this.$emit("resizing",this.left,this.top,this.width,this.height)};window.requestAnimationFrame(i)},getOrigin(){const t=this.$el.getBoundingClientRect();return{x:(t.left+t.right)/2,y:(t.bottom+t.top)/2}},handleMove(t){const e=this.lastMouseX,i=this.lastMouseY,s=-1!==t.type.indexOf("touchmove");this.mouseX=s?t.touches[0].clientX:t.pageX||t.clientX+document.documentElement.scrollLeft,this.mouseY=s?t.touches[0].clientY:t.pageY||t.clientY+document.documentElement.scrollTop;let n=this.mouseX-this.lastMouseX+this.mouseOffX,l=this.mouseY-this.lastMouseY+this.mouseOffY;this.mouseOffX=this.mouseOffY=0,this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY;const a=n,h=l;if(this.resizing)this.handle.indexOf("n")>=0&&(this.elmH-h<this.minh?this.mouseOffY=h-(l=this.elmH-this.minh):this.parent&&this.elmY+h<0&&(this.mouseOffY=h-(l=-this.elmY)),this.elmY+=l,this.elmH-=l),this.handle.indexOf("s")>=0&&(this.elmH+h<this.minh?this.mouseOffY=h-(l=this.minh-this.elmH):this.parent&&this.elmY+this.elmH+h>this.parentH&&(this.mouseOffY=h-(l=this.parentH-this.elmY-this.elmH)),this.elmH+=l),this.handle.indexOf("w")>=0&&(this.elmW-a<this.minw?this.mouseOffX=a-(n=this.elmW-this.minw):this.parent&&this.elmX+a<0&&(this.mouseOffX=a-(n=-this.elmX)),this.elmX+=n,this.elmW-=n),this.handle.indexOf("e")>=0&&(this.elmW+a<this.minw?this.mouseOffX=a-(n=this.minw-this.elmW):this.parent&&this.elmX+this.elmW+a>this.parentW&&(this.mouseOffX=a-(n=this.parentW-this.elmX-this.elmW)),this.elmW+=n),this.left=Math.round(this.elmX/this.grid[0])*this.grid[0],this.top=Math.round(this.elmY/this.grid[1])*this.grid[1],this.width=Math.round(this.elmW/this.grid[0])*this.grid[0],this.height=Math.round(this.elmH/this.grid[1])*this.grid[1],this.$emit("resizing",this.left,this.top,this.width,this.height);else if(this.dragging)this.parent&&(this.elmX+a<0?this.mouseOffX=a-(n=-this.elmX):this.elmX+this.elmW+a>this.parentW&&(this.mouseOffX=a-(n=this.parentW-this.elmX-this.elmW)),this.elmY+h<0?this.mouseOffY=h-(l=-this.elmY):this.elmY+this.elmH+h>this.parentH&&(this.mouseOffY=h-(l=this.parentH-this.elmY-this.elmH))),this.elmX+=n,this.elmY+=l,"x"!==this.axis&&"both"!==this.axis||(this.left=Math.round(this.elmX/this.grid[0])*this.grid[0]),"y"!==this.axis&&"both"!==this.axis||(this.top=Math.round(this.elmY/this.grid[1])*this.grid[1]),this.$emit("dragging",this.left,this.top);else if(this.rotating){const t=this.getOrigin(),s=Math.atan2(i-t.y,e-t.x),n=Math.atan2(this.mouseY-t.y,this.mouseX-t.x);this.rotateAngle+=Math.round(180*(n-s)/Math.PI),this.$emit("rotating",this.rotateAngle)}},handleUp(t){-1!==t.type.indexOf("touch")&&(this.lastMouseX=t.changedTouches[0].clientX,this.lastMouseY=t.changedTouches[0].clientY),this.handle=null,this.resizing&&(this.resizing=!1,this.$emit("resizestop",this.left,this.top,this.width,this.height)),this.dragging&&(this.dragging=!1,this.$emit("dragstop",this.left,this.top)),this.rotating&&(this.rotating=!1,this.$emit("rotatestop",this.rotateAngle)),this.elmX=this.left,this.elmY=this.top}}},c=r,u=(i("ef56"),i("2877")),d=Object(u["a"])(c,l,a,!1,null,"2432de98",null),m=d.exports,p={name:"ElementDrr",components:{VueDrr:m},props:{element:{type:Object,default:()=>{}},handles:{type:Array,default:()=>["n","e","s","w","nw","ne","se","sw"]}},watch:{element:{handler(t){this.$nextTick(()=>{this.updateHeight()})},deep:!0}},methods:{updateHeight(){if("text"===this.element.type){const t=this.$el;this.$nextTick(()=>{const e=Math.ceil(t.parentNode.getBoundingClientRect().height),i=Math.ceil(t.querySelector(".image-rich-text").getBoundingClientRect().height);this.element.y+i>=e&&(this.element.y=e-i),t.style.height=i+"px",this.element.h=i})}},handleDragStop(t,e){this.element.x===t&&this.element.y===e||(this.element.x=t,this.element.y=e)},handleResizing(){"text"===this.element.type&&this.updateHeight()},handleResizeStop(t,e,i,s){this.element.x===t&&this.element.y===e&&this.element.w===i&&this.element.h===s||(this.element.x=t,this.element.y=e,this.element.w=i,"text"===this.element.type?this.updateHeight():this.element.h=s)},handleDeactivate(){this.element.active=!1},handleActivated(){this.element.active=!0,this.$emit("updateActiveEle",this.element)}}},f=p,g=(i("8265"),Object(u["a"])(f,s,n,!1,null,null,null));e["a"]=g.exports},"3caf":function(t,e,i){},"4e87":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"image-rich-text",style:t.element.style,attrs:{spellcheck:"false",contenteditable:"true"},domProps:{innerHTML:t._s(t.innerText)},on:{focus:t.handleFocus,keydown:function(t){return t.stopPropagation()},keyup:function(e){return e.stopPropagation(),t.emitInput(e)},paste:function(e){return t.handlePaste(e)},click:function(t){t.stopPropagation()}}})},n=[],l=i("ed08"),a={name:"ImageRichText",props:{value:{type:String,default:"请输入文本"},element:{type:Object,default:()=>({style:{}})},activeEleText:{type:Object,default:()=>{}}},data(){return{innerText:this.value.replace(/\n/g,"<br>")}},watch:{value(t){this.innerText=t}},methods:{emitInput(t){this.$emit("input",t.target.innerHTML),this.keepCursorLast(t)},handlePaste(t){this.$emit("input",Object(l["c"])(t)),this.keepCursorLast(t)},keepCursorLast(t){this.$nextTick(()=>{Object(l["d"])(t.target)})},handleFocus(){this.activeEleText.active=!0}}},h=a,o=(i("52fc"),i("2877")),r=Object(o["a"])(h,s,n,!1,null,null,null);e["a"]=r.exports},"52fc":function(t,e,i){"use strict";i("0300")},8265:function(t,e,i){"use strict";i("8fce")},"892b":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-setting-wrapper"},[e("el-form",{attrs:{"label-width":"70px"}},[e("el-form-item",{attrs:{label:"文本"}},[e("ImageRichText",{staticClass:"text-editable",attrs:{"active-ele-text":t.activeEleText},model:{value:t.activeEleText.text,callback:function(e){t.$set(t.activeEleText,"text",e)},expression:"activeEleText.text"}})],1),e("el-form-item",{attrs:{label:"字体"}},[e("el-select",{attrs:{size:"small"},model:{value:t.activeEleText.style.fontFamily,callback:function(e){t.$set(t.activeEleText.style,"fontFamily",e)},expression:"activeEleText.style.fontFamily"}},t._l(t.fontFamilyData,(function(t){return e("el-option",{key:t.value,style:{fontFamily:t.value},attrs:{label:t.value,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"字号"}},[e("el-select",{attrs:{size:"small"},model:{value:t.activeEleText.style.fontSize,callback:function(e){t.$set(t.activeEleText.style,"fontSize",e)},expression:"activeEleText.style.fontSize"}},t._l(t.fontSizeData,(function(t){return e("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"颜色"}},[e("div",{staticClass:"color-box"},[e("i",{staticClass:"vue-dsn-icon-wenzise color-icon",style:{color:t.activeEleText.style.color}}),e("el-color-picker",{model:{value:t.activeEleText.style.color,callback:function(e){t.$set(t.activeEleText.style,"color",e)},expression:"activeEleText.style.color"}})],1),e("div",{staticClass:"color-box"},[e("i",{staticClass:"vue-dsn-icon-beijingse color-icon icon-bg",style:{color:t.activeEleText.style.backgroundColor}}),e("el-color-picker",{model:{value:t.activeEleText.style.backgroundColor,callback:function(e){t.$set(t.activeEleText.style,"backgroundColor",e)},expression:"activeEleText.style.backgroundColor"}})],1),e("div",{staticClass:"style-box"},[e("span",{class:["style-item",t.fontWeight?"active":""],on:{click:t.setFontWeight}},[e("i",{staticClass:"vue-dsn-icon-jiacu style-icon"})]),e("div",{staticClass:"style-item"},[e("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[e("i",{staticClass:"vue-dsn-icon-duiqi style-icon"}),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{style:t.setAlignActive("left"),attrs:{command:"left"}},[t._v("左对齐")]),e("el-dropdown-item",{style:t.setAlignActive("center"),attrs:{command:"center"}},[t._v("居中")]),e("el-dropdown-item",{style:t.setAlignActive("right"),attrs:{command:"right"}},[t._v("右对齐")])],1)],1)],1)])]),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.downloadImage}},[t._v("文本生成图片")])],1)],1)],1)},n=[],l=(i("14d9"),i("88a7"),i("271a"),i("5494"),i("ed08")),a=i("4e87");const h=[{value:"黑体"},{value:"宋体"},{value:"仿宋"},{value:"楷体"},{value:"隶书"},{value:"微软雅黑"},{value:"方正姚体"}],o=[{value:"12px"},{value:"14px"},{value:"16px"},{value:"18px"},{value:"24px"},{value:"32px"},{value:"48px"}];var r={name:"TextSetting",components:{ImageRichText:a["a"]},props:{activeEleText:{type:Object,default:()=>{}}},data(){return{fontFamilyData:h,fontSizeData:o}},computed:{fontWeight(){return 400!==+this.activeEleText.style.fontWeight}},watch:{activeEleText:{handler(t){this.activeEleText.style.lineHeight=t.style.fontSize},deep:!0}},methods:{setFontWeight(){400===+this.activeEleText.style.fontWeight?this.activeEleText.style.fontWeight=600:this.activeEleText.style.fontWeight=400},handleCommand(t){this.activeEleText.style.textAlign=t},setAlignActive(t){return this.activeEleText.style.textAlign===t?{backgroundColor:"#409eff",color:"#fff"}:{backgroundColor:"",color:"#333"}},textBecomeImg(t){const e=document.createElement("canvas");e.width=t.w,e.height=t.h;const i=e.getContext("2d"),s=4,n=8;i.fillStyle=t.style.backgroundColor||"transparent",i.fillRect(0,0,e.width,e.height),i.fillStyle=t.style.color,i.font=t.style.fontWeight+" "+t.style.fontSize+" "+t.style.fontFamily,i.textBaseline="top",i.textAlign=t.style.textAlign;const l=t.text.split("");let a="";const h=[],o=e.width-2*n;for(let c=0;c<l.length;c++)i.measureText(a).width<o&&i.measureText(a+l[c]).width<=o?a+=l[c]:(h.push(a),a=l[c]);let r;h.push(a),"left"===i.textAlign?r=n:"center"===i.textAlign?r=o/2:"right"===i.textAlign&&(r=o);for(let c=0;c<h.length;c++)i.fillText(h[c],r,parseInt(t.style.fontSize)*c+s,o);return e.toDataURL("image/png")},downloadImage(){const t=this.textBecomeImg(this.activeEleText),e=Object(l["a"])(t),i=document.createElement("a"),s=document.createEvent("HTMLEvents");s.initEvent("click",!0,!0),i.download="image.png",i.href=URL.createObjectURL(e),i.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}}},c=r,u=(i("fa7b"),i("2877")),d=Object(u["a"])(c,s,n,!1,null,null,null);e["a"]=d.exports},"8fce":function(t,e,i){},ef56:function(t,e,i){"use strict";i("1019")},fa7b:function(t,e,i){"use strict";i("3caf")}}]);