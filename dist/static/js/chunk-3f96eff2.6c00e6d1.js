(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3f96eff2"],{4753:function(e,t,s){"use strict";s("800a")},5960:function(e,t,s){"use strict";s("88ee")},"800a":function(e,t,s){},"88ee":function(e,t,s){},d0ea:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"import-excel-wrapper"},[t("Hints",[t("template",{slot:"hintName"},[e._v("JS-xlsx插件")]),t("template",{slot:"hintInfo"},[t("p",[e._v("JS-xlsx：由SheetJS出品的一款非常方便的只需要纯JS即可读取和导出excel的工具库，功能强大，支持xlsx、csv、txt等格式")]),t("p",[e._v("github地址：访问 "),t("el-link",{attrs:{type:"success",href:"https://github.com/SheetJS/sheetjs",target:"_blank"}},[e._v("JS-xlsx")])],1)])],2),t("el-card",{attrs:{shadow:"always"}},[t("UploadExcel",{on:{"on-success":e.handleSuccess}}),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark",size:"medium"}},e._l(e.tableHeader,(function(e){return t("el-table-column",{key:e,attrs:{prop:e,label:e,align:"center"}})})),1)],1)],1)},l=[],n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"upload-excel-wrapper"},[t("el-upload",{ref:"uploadExcel",attrs:{drag:"",action:"",accept:".xlsx, .xls, .csv",multiple:!1,"show-file-list":!1,"auto-upload":!1,limit:1,"on-exceed":e.handleLimit,"on-change":e.handleChange}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v("将Excel文件拖到此处，或"),t("em",[e._v("点击上传")])])])],1)},r=[],i=s("cd77"),c={name:"UploadExcel",methods:{handleLimit(){return this.$message.warning("Excel文件只支持单个上传!"),!1},handleChange(e){const t=e.raw;return!!t&&(this.isExcel(t)?void(this.isLimit1M(t)&&this.readFile(t)):(this.$message.warning("Excel文件只支持.xlsx, .xls, .csv格式!"),!1))},isLimit1M(e){const t=e.size/1024/1024<1;return!!t||(this.$message.warning("上传的Excel文件大小不能超过1M!"),!1)},isExcel(e){return/\.(xlsx|xls|csv)$/.test(e.name)},readFile(e){const t=new FileReader;t.onload=e=>{const t=e.target.result,{header:s,results:a}=i["a"].readDataFromExcel(t,"array");this.$emit("on-success",{header:s,results:a})},t.readAsArrayBuffer(e),t.onerror=e=>{this.$message.error("Excel文件读取出错!")},this.$refs.uploadExcel.clearFiles()}}},o=c,u=(s("4753"),s("2877")),d=Object(u["a"])(o,n,r,!1,null,null,null),h=d.exports,x=s("b522"),p={name:"ImportExcel",components:{UploadExcel:h,Hints:x["a"]},data(){return{tableHeader:[],tableData:[]}},methods:{handleSuccess({header:e,results:t}){this.tableHeader=e,this.tableData=t}}},m=p,f=(s("5960"),Object(u["a"])(m,a,l,!1,null,null,null));t["default"]=f.exports}}]);