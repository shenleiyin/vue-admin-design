(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f598cba"],{2501:function(t,e,i){},d594:function(t,e,i){"use strict";i("2501")},deda:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"image-compress"},[e("Hints",[e("template",{slot:"hintName"},[t._v("图片压缩")]),e("template",{slot:"hintInfo"},[e("p",[t._v("纯JS实现对图片的等比压缩和放大的功能，并对图片进行下载")])])],2),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:16}},[e("el-card",{attrs:{shadow:"always"}},[e("div",{staticClass:"title",attrs:{slot:"header"},slot:"header"},[t._v("图片区域")]),e("div",{staticClass:"box-wrapper"},[e("div",{staticClass:"image-container",style:t.imageStyle})])])],1),e("el-col",{attrs:{span:8}},[e("el-card",{attrs:{shadow:"always"}},[e("div",{staticClass:"title",attrs:{slot:"header"},slot:"header"},[t._v("设置区域")]),e("div",{staticClass:"box-content"},[e("el-form",{attrs:{"label-width":"82px","label-position":"left"}},[e("el-form-item",{attrs:{label:"选择图片："}},[e("UploadImage",{staticClass:"select-image",attrs:{"btn-name":"选择图片"},on:{"on-success":t.handleSuccess}})],1),e("el-form-item",{attrs:{label:"图片尺寸："}},[e("div",{staticClass:"ratio-size"},[e("el-input",{nativeOn:{keyup:function(e){return t.bindInput("h")}},model:{value:t.imageObj.width,callback:function(e){t.$set(t.imageObj,"width",t._n(e))},expression:"imageObj.width"}}),e("i",{staticClass:"vue-dsn-icon-edit-img-size-locking icon-link"}),e("el-input",{nativeOn:{keyup:function(e){return t.bindInput("w")}},model:{value:t.imageObj.height,callback:function(e){t.$set(t.imageObj,"height",t._n(e))},expression:"imageObj.height"}}),e("ul",{staticClass:"ratio-type clearfix"},[e("li",[t._v("宽")]),e("li",[t._v("高")])])],1)]),e("el-form-item",{staticClass:"item-ratio",attrs:{label:"压缩比例："}},[e("el-input",{attrs:{disabled:""},model:{value:t.imageObj.ratio,callback:function(e){t.$set(t.imageObj,"ratio",t._n(e))},expression:"imageObj.ratio"}})],1),e("el-form-item",{attrs:{label:"图片质量："}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.imageObj.quality,callback:function(e){t.$set(t.imageObj,"quality",e)},expression:"imageObj.quality"}},t._l(t.qualityOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",[e("el-button",{staticClass:"btn-compress",attrs:{type:"primary"},on:{click:t.compressImage}},[t._v("压缩图片")])],1)],1)],1)])],1)],1)],1)},s=[],l=(i("88a7"),i("271a"),i("5494"),i("b522")),h=i("6b45"),n=i("ed08");const o=[{label:100,value:1},{label:90,value:.9},{label:80,value:.8},{label:70,value:.7},{label:60,value:.6},{label:50,value:.5}];var g={name:"ImageCompress",components:{Hints:l["a"],UploadImage:h["a"]},data(){return{image:{width:1920,height:1080,src:"https://cdn.jsdelivr.net/gh/baimingxuan/media-store/images/img03.jpg"},imageShow:{width:0,height:0,imgSrc:""},imageObj:{width:0,height:0,ratio:"100%",quality:1},qualityOptions:o}},computed:{imageStyle(){return{width:this.imageShow.width+"px",height:this.imageShow.height+"px",backgroundImage:"url('"+this.imageShow.imgSrc+"')"}},imageRatio(){return this.image.width/this.image.height}},watch:{image:{handler(t){this.getDragContainerSize(t.width,t.height),this.imageShow.imgSrc=t.src,this.imageObj.width=t.width,this.imageObj.height=t.height,this.imageObj.ratio="100%",this.imageObj.quality=1},deep:!0}},created(){this.getDragContainerSize(this.image.width,this.image.height),this.imageShow.imgSrc=this.image.src,this.imageObj.width=this.image.width,this.imageObj.height=this.image.height},methods:{bindInput(t){"h"===t?this.imageObj.height=Math.round(this.imageObj.width/this.imageRatio).toFixed(0):"w"===t&&(this.imageObj.width=Math.round(this.imageObj.height*this.imageRatio).toFixed(0)),this.imageObj.ratio=(this.imageObj.width/this.image.width*100).toFixed(2)+"%"},getDragContainerSize(t,e){const[i,a]=[850,550],s=Object(n["b"])(t,e,i,a);this.imageShow.width=s.width,this.imageShow.height=s.height},handleSuccess(t){this.image.src=t;const e=new Image;e.src=t,e.onload=()=>{this.image.width=e.width,this.image.height=e.height}},compressImage(){const t=this.imageObj.width,e=this.imageObj.height,i=this.imageObj.quality,a=new Image;a.src=this.image.src,a.onload=()=>{const s=document.createElement("canvas"),l=s.getContext("2d"),h=document.createAttribute("width");h.nodeValue=t;const n=document.createAttribute("height");n.nodeValue=e,s.setAttributeNode(h),s.setAttributeNode(n),l.fillRect(0,0,t,e),l.drawImage(a,0,0,t,e);const o=s.toDataURL("image/png",i);this.downloadImage(o)}},downloadImage(t){const e=Object(n["a"])(t),i=document.createElement("a"),a=document.createEvent("HTMLEvents");a.initEvent("click",!0,!0),i.download="image.png",i.href=URL.createObjectURL(e),i.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}}},m=g,r=(i("d594"),i("2877")),c=Object(r["a"])(m,a,s,!1,null,null,null);e["default"]=c.exports}}]);